<!DOCTYPE html>
<html lang="en-us">
<head>





<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Python源码学习1 对象的秘密 - Chimission&#39;s Notes</title>
<meta name="description" content="">

<meta name="author" content="">

<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4">
<link rel="alternate" href="/index.xml?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4" type="application/rss+xml" title="RSS" />
<meta property="og:title" content="Python源码学习1 对象的秘密 - Chimission&#39;s Notes">
</meta>
<meta property="og:url" content="https://notes.chimission.cn/posts/python_object/">
<meta property="og:type" content="article">
<meta property="og:site_name" content="Chimission&#39;s Notes">
<meta property="og:description" content="">

<meta property="og:image" content="https://notes.chimission.cn//images/featured_image.jpg">

<meta name="twitter:card" content="summary_large_image" /></meta>
<meta name="twitter:site" content="@"></meta>
<meta name="twitter:creator" content="@"></meta>
<meta name="twitter:title" content="Python源码学习1 对象的秘密 - Chimission&#39;s Notes"></meta>
<meta name="twitter:url" content="https://notes.chimission.cn/posts/python_object/"></meta>
<meta name="twitter:description" content=""></meta>

<meta property="og:image" content="https://notes.chimission.cn//images/featured_image.jpg">


<link rel="stylesheet" href="/css/main.css?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4">
<link rel="stylesheet" href="/css/color.css?c=650c9b832a9ac9cb916a1980f7aa3cd07f1e9ab4">




</head>

<body class="theme-default">


<div id="content-header" class="title">
  
  <a class="site-title" href="/">Chimission&#39;s Notes</a>
  
  <span class="site-sub-title"></span>

  

  <div id="main-menu-nav">
    <div id="main-menu-nav-items">
      
        <div class="nav-item"><a href="/about/">About</a></div>
      
        <div class="nav-item"><a href="/tags/">Tags</a></div>
      
        <div class="nav-item"><a href="/categories/">Categories</a></div>
      
        <div class="nav-item"><a href="/archives/">Archives</a></div>
      
    </div>
  </div>
</div>
<div id="content" class="main">




<h2>Python源码学习1 对象的秘密</h2>

<span class="sub">2023-01-03</span>








<blockquote>
<p>天天写python,新年开始咱也试着学习下python源码</p>
</blockquote>
<h3 id="1everything-in-python-is-an-object">1.Everything in Python is an object</h3>
<p>在 python 中，一切都是「对象」。但是这句话代表什么含义？ 英文原文「Everything in Python is an object」。「对象」对应英文中的「object」，在面向对象的语言中，「object」和「class」（类）是成对出现的，通常来讲「class」是数据的抽象模型，「object」是「class」的实体表现，但在 python 中对象的含义并非如此简单。我认为 一切都是「对象」有3层表达含义：</p>
<blockquote>
<ol>
<li>几乎所有的东西都是某个类的实例「instance」</li>
<li>几乎所有的东西都具有属性「attributes」</li>
<li>几乎所有的东西都可以被变量赋值从而被函数参数传递「variable」</li>
</ol>
</blockquote>
<p>这里讲几乎所有是因为要排除诸如「for」「def」等关键字。</p>
<p>让我们来依次举例说明这3条含义，首先是第一条：「几乎所有的东西都是某个类的实例」</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># type用于获取对象的类型 isinstance用于判断是不是某个类型的实例</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">from</span> <span style="color:#0cf;font-weight:bold">types</span> <span style="color:#069;font-weight:bold">import</span> FunctionType
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">Person</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">test</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#c30">&#34;Hello&#34;</span>), <span style="color:#366">isinstance</span>(<span style="color:#c30">&#34;Hello&#34;</span>, <span style="color:#366">str</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#f60">100</span>), <span style="color:#366">isinstance</span>(<span style="color:#f60">100</span>, <span style="color:#366">int</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#f60">100.23</span>), <span style="color:#366">isinstance</span>(<span style="color:#f60">100.23</span>, <span style="color:#366">float</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#f60">100</span> <span style="color:#555">+</span> <span style="color:#f60">2</span>j), <span style="color:#366">isinstance</span>(<span style="color:#f60">100</span> <span style="color:#555">+</span> <span style="color:#f60">2</span>j, <span style="color:#366">complex</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#069;font-weight:bold">True</span>), <span style="color:#366">isinstance</span>(<span style="color:#069;font-weight:bold">True</span>, <span style="color:#366">bool</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(<span style="color:#069;font-weight:bold">None</span>), <span style="color:#366">isinstance</span>(<span style="color:#069;font-weight:bold">None</span>, <span style="color:#366">type</span>(<span style="color:#069;font-weight:bold">None</span>)))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>([]), <span style="color:#366">isinstance</span>([], <span style="color:#366">list</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(()), <span style="color:#366">isinstance</span>((), <span style="color:#366">tuple</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>({}), <span style="color:#366">isinstance</span>({}, <span style="color:#366">dict</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>({<span style="color:#c30">&#34;&#34;</span>}), <span style="color:#366">isinstance</span>({<span style="color:#c30">&#34;&#34;</span>}, <span style="color:#366">set</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(Person), <span style="color:#366">isinstance</span>(Person, <span style="color:#366">type</span>))
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">type</span>(test), <span style="color:#366">isinstance</span>(test, FunctionType))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># 输出</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;str&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;int&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;float&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;complex&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;bool&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;NoneType&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;list&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;tuple&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;dict&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;set&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;type&#39;&gt; True</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;function&#39;&gt; True</span>
</span></span></code></pre></div><p>可以看到所有的变量或者类甚至是函数都有自己的类型，并且是某个类型的实例。需要注意的是「Person」类型，它本身是一个类，但是通过「type」函数得到了它的类型是「type」，而它自身也确实是「type」的实例，这个我们后面会继续讲到。</p>
<p>然后是第二条「几乎所有的东西都具有属性」：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># 内建函数dir用于获取对象参数的属性</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">test</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(<span style="color:#366">dir</span>(test))
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># 输出</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#[&#39;__annotations__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__call__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__class__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__closure__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__code__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__defaults__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__delattr__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__dict__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__dir__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__doc__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__eq__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__format__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__ge__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__get__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__getattribute__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__globals__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__gt__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__hash__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__init__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__init_subclass__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__kwdefaults__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__le__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__lt__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__module__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__name__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__ne__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__new__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__qualname__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__reduce__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__reduce_ex__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__repr__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__setattr__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__sizeof__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__str__&#39;,</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># &#39;__subclasshook__&#39;]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#366">print</span>(test<span style="color:#555">.</span>__class__)
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># 输出</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic"># function</span>
</span></span></code></pre></div><p>这里我声明了一个空函数，即使是空函数也包含了很多内建属性和方法， 篇幅有限其他就不演示了，大家可以在自己电脑上试一试。</p>
<p>最后是第三条「几乎所有的东西都可以被变量赋值从而被函数参数传递」：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#069;font-weight:bold">class</span> <span style="color:#0a8;font-weight:bold">Test</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">test</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#069;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#069;font-weight:bold">def</span> <span style="color:#c0f">print_type</span>(var):
</span></span><span style="display:flex;"><span>    <span style="color:#366">print</span>(<span style="color:#366">type</span>(var))
</span></span><span style="display:flex;"><span>a<span style="color:#555">=</span><span style="color:#366">int</span>
</span></span><span style="display:flex;"><span>print_type(a)
</span></span><span style="display:flex;"><span>a<span style="color:#555">=</span>test
</span></span><span style="display:flex;"><span>print_type(a)
</span></span><span style="display:flex;"><span>a<span style="color:#555">=</span><span style="color:#f60">1</span>
</span></span><span style="display:flex;"><span>print_type(a)
</span></span><span style="display:flex;"><span>a<span style="color:#555">=</span>Test
</span></span><span style="display:flex;"><span>print_type(Test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#输出</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;type&#39;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;function&#39;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;int&#39;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#09f;font-style:italic">#&lt;class &#39;type&#39;&gt;</span>
</span></span></code></pre></div><p>可以看到 无论是内建类型 int ，自定义类型 Test 还是函数test，都可以赋值给变量a，然后通过参数传递给函数执行。由此我们可以想到 python 在内部一定是统一了「对象」的表示，以此来实现「一切皆对象」的表现形式，可以使用统一的API来管理python的对象。</p>
<h3 id="pyobject对象的统一表示">PyObject，对象的统一表示</h3>
<p>未完待续，本章后续会继续探索pyton源码，找出python里「一切皆对象」是如何实现的。</p>
<h3 id="参考">参考</h3>
<p><a href="https://linux.die.net/diveintopython/html/getting_to_know_python/everything_is_an_object.html">1.https://linux.die.net/diveintopython/html/getting_to_know_python/everything_is_an_object.html</a><br>
<a href="https://stackoverflow.com/questions/865911/is-everything-an-object-in-python-like-ruby">2.https://stackoverflow.com/questions/865911/is-everything-an-object-in-python-like-ruby</a></p>





<hr class="block-separater">




<div class="content-footer-item">
	Tags for this post:
	
	<a class="post-tag" href="/tags/python/">python</a>
	
	<a class="post-tag" href="/tags/%E6%BA%90%E7%A0%81/">源码</a>
	
</div>







<div class="content-footer-item neighbor">
	
	<div class="prev-post">Prev: <a href="/posts/leetcode_hash_1/">Leetcode 哈希篇</a></div>
	
	
</div>






    
    
    






    
    
    

    
    
    




<script src="/js/single.js"></script>


	</div><div id="content-footer" class="sub">
  Copyright © 2022, Chimission; all rights reserved.
  <div class="credit">
    Power by <a href="https://gohugo.io">Hugo</a> /
    Theme <a href="https://github.com/michimani/simplog/">simplog</a> by <a href="https://github.com/michimani/">michimani</a>
  </div>
</div></body>

</html>